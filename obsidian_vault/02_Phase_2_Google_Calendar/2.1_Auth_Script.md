# 2.1 Google Auth Script
Status: - [x] Completed

## Description
Create the Google OAuth2 authentication flow that allows the app to access Google Calendar on behalf of the user. This enables both the Capture System (writing events) and the Morning Briefing (reading today's schedule).

## Files to Create/Edit
- [ ] `src/integrations/google_auth.py`

## Prompt for Claude
```
You are building **LifeOS Assistant**. This module enables Google Calendar access, which is critical for two pillars: the **Capture System** (writing events) and the **Morning Briefing** (reading today's schedule). Without auth, neither pillar works.

The config module exists at `src/config.py` with a `settings` object containing `GOOGLE_CREDENTIALS_PATH` and `GOOGLE_TOKEN_PATH`.

Create `src/integrations/google_auth.py` with the following:

1. Create a function `get_calendar_service()` that:
   - Checks if a token file exists at `settings.GOOGLE_TOKEN_PATH`.
   - If it exists, load the credentials from it.
   - If the credentials are expired but have a refresh token, refresh them automatically.
   - If no valid credentials exist, run the OAuth2 installed-app flow using the credentials file at `settings.GOOGLE_CREDENTIALS_PATH`.
   - Save the new/refreshed token back to the token file.
   - Build and return a Google Calendar API service object (`googleapiclient.discovery.build('calendar', 'v3', credentials=creds)`).

2. The required OAuth2 scope is: `https://www.googleapis.com/auth/calendar`

3. Use these libraries:
   - `google.oauth2.credentials.Credentials`
   - `google_auth_oauthlib.flow.InstalledAppFlow`
   - `google.auth.transport.requests.Request`
   - `googleapiclient.discovery`

4. Add a `if __name__ == "__main__"` block that runs the auth flow interactively so the user can authorize the app by running `python -m src.integrations.google_auth`.

5. Include proper error handling and logging.

Use `from src.config import settings` for paths.
```

## Implementation Logs
- **Commit:** `af4b62f` — feat(calendar): 2.1 Auth Script
- **Files created:**
  - `src/integrations/google_auth.py` — OAuth2 flow with token persistence + `get_calendar_service()`
